@import (reference) '../variables.less';

/* == 非页面正文 == */

/* 隐藏首页的页顶、页尾及其他无用要素 */
.page-Qiuwen_首页 {
	&.action-view {
		.mw-indicators,
		#contentSub,
		#siteSub,
		.firstHeading,
		.mw-redirectedfrom,
		.vector-article-toolbar,
		#mw-page-header-links,
		#mw-related-navigation {
			display: none !important;
		}

		&.skin-citizen {
			.citizen-body-container {
				gap: var(--space-xxs);
			}

			.citizen-body {
				/* 隐藏页边 */
				grid-area: unset;
			}

			.mw-body-header {
				#p-views {
					/* 隐藏页头部分按钮 */
					display: none;
				}
			}

			&.citizen-body-header--sticky {
				.mw-body-header {
					visibility: hidden;
				}
			}

			.citizen-footer {
				position: relative;
			}
		}

		&.skin-vector-2022 {
			.vector-page-toolbar {
				/* 隐藏工具栏 */
				display: none;
			}
		}

		&.skin-citizen .mw-body,
		&.skin-gongbi #mw-content,
		&.skin-vector .mw-body {
			/* 背景 */
			background: var(--mp-background-color--light, @background-color-primary--light);

			.client-darkmode & {
				background: @const-color-gray--dark;
			}
		}
	}

	#catlinks {
		/* 隐藏首页下方的Catlink */
		display: none;
	}

	#footer-info-lastmod {
		/* 隐藏首页下方的“最后编辑于” */
		display: none;
	}
}

/* 禁止删除首页及其相关模板 */
.rootpage-Qiuwen_首页,
.rootpage-Template_新版首页 {
	#ca-delete,
	#deleteconfirm {
		display: none !important;
	}
}

/* == 页面正文 == */
.mainpage {
	display: flex;
	flex-flow: row wrap;
	align-items: stretch;
	gap: 0.5em;
	border-radius: @border-radius--small;
	line-height: 1.5;
	background: transparent;
	place-content: center center;

	.skin-gongbi & {
		padding: 1em;
	}

	.client-darkmode & {
		color: @const-color-black;
	}

	&-code {
		display: none;
	}

	/* Normalize */
	h2 {
		flex: 1 1 100%;
		max-width: 100%;
		padding: 0.5em;
		border: 0;
		border-radius: @border-radius--small;
		margin: 0 auto 0.5em;
		background: var(--mp--color, @color--primary);
		color: @const-color-white;
		font-size: 1.25em;
		font-weight: normal;
		text-align: center;

		&::after {
			border-bottom: 0 !important;
		}

		.mw-headline {
			&::before,
			&::after {
				color: @const-color-white;
				font-weight: normal;
			}

			&::before {
				margin-right: 0.5em;
				content: '［';
			}

			&::after {
				margin-left: 0.5em;
				content: '］';
			}
		}
	}

	a.new {
		color: inherit;
	}

	ul,
	ol,
	p {
		line-height: 1.75;
	}

	figure {
		margin: 1em;

		&[typeof~='mw:File/Thumb'],
		&[typeof~='mw:File/Frame'] {
			border: 0;
			background: transparent;
			box-shadow: none;
			margin-bottom: 1.5em;

			& > a.mw-file-description::after {
				display: none;
			}
		}

		img {
			border: 0;
		}
	}

	.thumbcaption,
	figcaption {
		text-align: center !important;
		border: 0 !important;
		background-color: transparent !important;
		box-shadow: none !important;

		&::before {
			display: none;
		}
	}

	.tmulti .trow {
		justify-content: center;
	}

	img {
		border-radius: 0;
	}

	.cdx-button--action-progressive {
		border-color: var(--mp--color, @color--primary);
		background-color: var(--mp--color, @color--primary);
	}

	ul.gallery {
		margin: auto;
		text-align: center;
	}

	li.gallerybox div.thumb {
		border: 0;
		background: none;
	}

	div.caption {
		margin: 0.5em auto;
		font-size: 0.95em;
		line-height: 1.2;
		text-align: center;
	}

	&-box,
	&-header-box,
	&-footer-box {
		display: flex;
		flex-flow: row wrap;
		place-content: space-between center;
		align-items: center;
		padding: 1em;
		border-radius: @border-radius--small;
		background: var(--mp-background-color-light, @background-color-light);
		box-shadow:
			0 1px 2px var(--mp-background-color--light, @background-color-primary--light),
			0 -1px 2px var(--mp-background-color--light, @background-color-primary--light);
		break-inside: avoid;

		.client-darkmode & {
			border: 0;
			background: var(--mp-background-color--light, @background-color-primary--light);
			box-shadow:
				0 1px 2px var(--mp-background-color--darkest, @background-color-primary--darkest),
				0 -1px 2px var(--mp-background-color--darkest, @background-color-primary--darkest) !important;
		}

		& > div {
			padding: 0.5em;
			flex: 1 1 100%;
		}
	}

	&-box {
		flex: 1 1 20em;
		flex: 1 1 calc(33% - 3.3em);
		width: 33%;

		img {
			max-width: 20em;
			height: auto;
		}

		&-footer {
			display: flex;
			flex: 1 1 100%;
			justify-content: flex-end;
		}
	}

	&-header-box,
	&-footer-box {
		flex: 1 1 100%;
		width: 100%;
	}

	&-wide-box {
		flex: 1 1 33.3em;
		flex: 1 1 calc(50% - 5em);
	}

	&-extra-box {
		flex: 1 1 100%;
	}

	&-top-menu {
		display: flex;
		flex: 1 1 100%;
		max-width: 100%;
		flex-flow: row wrap;
		justify-content: end;
		padding: 0;

		li {
			display: flex;
			align-items: center;
			font-size: 1.1em;
			list-style-type: none;
			text-align: center;
		}
	}

	&-header {
		display: flex;
		flex: 1 1 100%;
		max-width: 100%;
		flex-flow: row wrap;
		justify-content: space-between;
		padding: 0;

		.mainpage-header-bio {
			display: flex;
			flex: 1 1 100%;
			gap: 1em;
			align-items: center;
			place-content: center center;
			flex-flow: column wrap;
		}

		.mainpage-slogan,
		.mainpage-search {
			&,
			& * {
				display: flex;
				width: auto;
				align-items: center;
				place-content: center center;
				flex-wrap: wrap;
				gap: 0.5em;
			}
		}

		img {
			max-width: 92.5%;
			height: auto;
		}

		.mainpage-slogan {
			img {
				margin-bottom: 0.25em;
			}
		}

		.mainpage-search {
			&,
			& * {
				max-width: 50vw;
			}
		}

		&-box {
			padding: 1em;
			position: relative;

			.mainpage-login-menu {
				display: flex;
				flex: 1 1 100%;
				position: relative;
				margin: 0 1em 0 auto;
				padding: 0;
				place-content: flex-end flex-end;
				align-items: center;
				flex-flow: column wrap;
			}

			& > div {
				padding: 0.5em;
			}
		}

		.mainpage-articlecount {
			color: @const-color-secondary;
			font-size: 1.125em;
			font-weight: normal;

			.client-darkmode & {
				color: @const-color-primary;
			}
		}
	}

	&-link-button {
		cursor: pointer;
		border: 0;
		border-radius: @border-radius--small;
		margin: auto;
		padding: @border-radius--small @border-radius--medium;
		transition: background 0.1s ease-in-out;

		img {
			.client-darkmode & {
				box-shadow: none;
				filter: invert(0) !important;
			}
		}

		&:hover {
			background: var(--mp--color, @color--primary);
			color: @const-color-white;

			a {
				&,
				&.extiw,
				&.external {
					&,
					&:visited {
						&,
						&:hover {
							color: @const-color-white;
							text-decoration: none;
						}
					}
				}
			}

			img {
				box-shadow: none;
				filter: invert(1) hue-rotate(180deg);

				.client-darkmode & {
					filter: invert(0);
				}
			}
		}
	}

	.guidelist {
		ul {
			display: flex;
			flex-wrap: wrap;
			place-content: center center;
			align-items: center;
			margin: auto;
			gap: 0.5em 1em;
		}

		li {
			font-size: 1.125em;
			list-style-type: none;
			text-align: center;

			&::marker {
				content: '';
			}
		}
	}

	#mainpage-sisterproject-box {
		.guidelist {
			display: flex;
			flex-flow: row wrap;
			gap: 0.5em 1em;
			place-content: center space-around;
			align-items: center;

			.mainpage-sisterproject-item {
				display: flex;
				flex-flow: row nowrap;
				align-items: center;
				justify-content: center;
				gap: 0.5em 1em;
				margin: 0.25em;

				img {
					max-width: 32px;
				}
			}
		}
	}

	#mainpage-sns-box .guidelist {
		display: flex;
		flex-wrap: wrap;
		place-content: space-around space-evenly;
		align-items: flex-end;
		gap: 1em;
	}

	&-feedback {
		flex: 1 1 100%;
		padding: 0.5em 2.5em;
		margin: 0 0 auto auto;
		text-align: right;
		font-size: 0.875em;
	}

	@media screen and (max-width: 1024px) {
		&-header {
			min-height: 125px;
		}

		&-header-box,
		&-box,
		&-footer-box {
			margin: 0 auto;
			flex: 1 1 45em;
			flex: 1 1 calc(100% - 10em);
			width: 100%;
			max-width: 100%;
		}

		figure {
			&.mw-halign-left,
			&.mw-halign-right,
			&.mw-halign-center {
				margin: auto;
				text-align: center;
			}
		}
	}

	@media screen and (min-width: 1024px) {
		&-header-box {
			display: flex;
			flex-direction: row;
			align-items: center;

			.mainpage-login-menu {
				position: absolute;
				top: 0;
				right: 0;
				padding: 0;
			}
		}

		.mainpage-header-bio {
			width: 100%;
			margin: 0 auto;
		}
	}
}
